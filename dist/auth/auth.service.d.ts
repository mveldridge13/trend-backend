import { JwtService } from "@nestjs/jwt";
import { UsersRepository } from "../users/repositories/users.repository";
import { AuditService } from "../audit/audit.service";
import { HibpService } from "../common/services/hibp.service";
import { RegisterDto } from "./dto/register.dto";
import { LoginDto } from "./dto/login.dto";
import { AuthResponseDto } from "./dto/auth-response.dto";
import { UpdateUserProfileDto } from "../users/dto/update-user-profile.dto";
import { ChangePasswordDto } from "./dto/change-password.dto";
import { SessionListResponseDto, RevokeSessionResponseDto, RevokeOtherSessionsResponseDto } from "./dto/session.dto";
import { IncomeFrequency } from "@prisma/client";
export declare class AuthService {
    private readonly usersRepository;
    private readonly jwtService;
    private readonly auditService;
    private readonly hibpService;
    constructor(usersRepository: UsersRepository, jwtService: JwtService, auditService: AuditService, hibpService: HibpService);
    private generateRefreshToken;
    private isAccountLocked;
    register(registerDto: RegisterDto, ipAddress?: string, userAgent?: string): Promise<AuthResponseDto>;
    login(loginDto: LoginDto, ipAddress?: string, userAgent?: string): Promise<AuthResponseDto>;
    refreshToken(refreshToken: string, ipAddress?: string, userAgent?: string): Promise<{
        access_token: string;
        refresh_token: string;
        expires_in: number;
    }>;
    logout(userId: string, refreshToken?: string, ipAddress?: string, userAgent?: string): Promise<{
        success: boolean;
        message: string;
    }>;
    validateUser(id: string): Promise<any>;
    getUserProfile(id: string): Promise<{
        id: string;
        email: string;
        firstName: string;
        lastName: string;
        username: string | null;
        currency: string;
        timezone: string;
        isActive: boolean;
        createdAt: Date;
        updatedAt: Date;
        income?: number;
        incomeFrequency?: IncomeFrequency;
        nextPayDate?: Date;
        fixedExpenses?: number;
        setupComplete: boolean;
        hasSeenWelcome: boolean;
        hasSeenBalanceCardTour: boolean;
        hasSeenAddTransactionTour: boolean;
        hasSeenTransactionSwipeTour: boolean;
    }>;
    updateUserProfile(id: string, profileData: UpdateUserProfileDto): Promise<{
        id: string;
        email: string;
        firstName: string;
        lastName: string;
        username: string | null;
        currency: string;
        timezone: string;
        isActive: boolean;
        createdAt: Date;
        updatedAt: Date;
        income?: number;
        incomeFrequency?: IncomeFrequency;
        nextPayDate?: Date;
        fixedExpenses?: number;
        setupComplete: boolean;
        hasSeenWelcome: boolean;
        hasSeenBalanceCardTour: boolean;
        hasSeenAddTransactionTour: boolean;
        hasSeenTransactionSwipeTour: boolean;
    }>;
    changePassword(userId: string, changePasswordDto: ChangePasswordDto, ipAddress?: string, userAgent?: string): Promise<{
        success: boolean;
        message: string;
    }>;
    getActiveSessions(userId: string, currentToken?: string): Promise<SessionListResponseDto>;
    revokeSession(userId: string, sessionId: string, currentToken?: string): Promise<RevokeSessionResponseDto>;
    revokeOtherSessions(userId: string, currentToken: string, ipAddress?: string, userAgent?: string): Promise<RevokeOtherSessionsResponseDto>;
}
